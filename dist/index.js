"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0});var Utils=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"parent",value:function(t){return(t-1)/2|0}},{key:"grandParent",value:function(t){return(t-1)/4|0}},{key:"left",value:function(t){return 2*t+1}},{key:"right",value:function(t){return 2*t+2}},{key:"child",value:function(t){return 2*t+1}},{key:"grandChild",value:function(t){return 4*t+3}},{key:"swap",value:function(t,e){var i=t;return t=e,[e=i,t]}}]),t}(),MinMaxHeap=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(t,e){return t<e};_classCallCheck(this,a),this.comparator=i,this.duplicate=e,this.hasData=t,this._heap=[],this._data=[],this._size=0}return _createClass(a,[{key:"init",value:function(){this._heap=[],this._size=0}},{key:"clear",value:function(){this.init()}},{key:"empty",value:function(){return 0===this._size}},{key:"hasParent",value:function(t){return 0!==t&&0<=Utils.parent(t)}},{key:"hasGrandParent",value:function(t){return!!this.hasParent(t)&&0<=Utils.grandParent(t)}},{key:"hasChild",value:function(t){return Utils.child(t)<this._size}},{key:"hasGrandChild",value:function(t){return Utils.grandChild(t)<this._size}},{key:"hasLeft",value:function(t){return Utils.left(t)<this._size}},{key:"hasRight",value:function(t){return Utils.right(t)<this._size}},{key:"isMinLevel",value:function(t){return 1&(0|Math.log2(t+1))}},{key:"isMaxLevel",value:function(t){return!this.isMinLevel(t)}},{key:"swap",value:function(t,e){var i=[this._heap[e],this._heap[t]];this._heap[t]=i[0],this._heap[e]=i[1];var a=[this._data[e],this._data[t]];this._data[t]=a[0],this._data[e]=a[1]}},{key:"_bubbleUp",value:function(t,e){if(0!==t){var i=Utils.parent(t);if(0!==i){var a=Utils.parent(i);this.comparator(this._heap[t],this._heap[a])^e&&(this.swap(t,a),this._bubbleUp(a,e))}}}},{key:"bubbleUp",value:function(t){if(0!==t){var e=Utils.parent(t);this.isMinLevel(t)?this.comparator(this._heap[t],this._heap[e])?this._bubbleUp(t,!1):(this.swap(t,e),this._bubbleUp(e,!0)):this.comparator(this._heap[t],this._heap[e])?(this.swap(t,e),this._bubbleUp(e,!1)):this._bubbleUp(t,!0)}}},{key:"_getMinChild",value:function(t,e){var i=t;if(!this.hasChild(t))return i;for(var a=Utils.child(t),s=0;s<2&&a+s<this._size;s++)this.comparator(this._heap[a+s],this._heap[i])^e&&(i=a+s);for(var n=Utils.child(a),h=0;h<4&&n+h<this._size;h++)this.comparator(this._heap[n+h],this._heap[i])^e&&(i=n+h);return i}},{key:"_trickleDown",value:function(t,e){if(!(t>=this._size)){var i=Utils.child(t),a=this._getMinChild(t,e);a!==t&&(this.swap(a,t),1<a-i&&(this.comparator(this._heap[Utils.parent(a)],this._heap[a])^e&&this.swap(Utils.parent(a),a),this._trickleDown(a,e)))}}},{key:"trickleDown",value:function(t){this.isMinLevel(t)?this._trickleDown(t,!1):this._trickleDown(t,!0)}},{key:"getMinIndex",value:function(){return 0===this._size?null:1===this._size?0:2===this._size?1:this.comparator(this._heap[1],this._heap[2])?1:2}},{key:"add",value:function(t,e){this._heap.push(t),this._data.push(e),this._size+=1}},{key:"remove",value:function(t){if(t>=this._size)return null;var e=null,i=null;if(t===this._size-1){var a=[this._heap.pop(),this._data.pop()];return e=a[0],i=a[1],this._size-=1,this.hasData?[e,i]:e}this.swap(t,this._size-1);var s=[this._heap.pop(),this._data.pop()];e=s[0],i=s[1],this._size-=1,this.trickleDown(t)}},{key:"push",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.add(t,e),this.bubbleUp(this._size-1)}},{key:"max",value:function(){return this.empty()?null:this.hasData?[this._heap[0],this._data[0]]:this._heap[0]}},{key:"min",value:function(){if(this.empty())return null;var t=this.getMinIndex();return this.hasData?[this._heap[t],this._data[t]]:this._heap[t]}},{key:"popMin",value:function(){if(this.empty())return null;var t=this.getMinIndex(),e=[this._heap[t],this._data[t]],i=e[0],a=e[1];return this.remove(t),this.hasData?[i,a]:i}},{key:"popMax",value:function(){if(this.empty())return null;var t=[this._heap[0],this._data[0]],e=t[0],i=t[1];return this.remove(0),this.hasData?[e,i]:e}},{key:"pop",value:function(){return!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?this.popMax():this.popMin()}},{key:"heap",get:function(){return this._heap}},{key:"size",get:function(){return this._size}}]),a}();exports.MinMaxHeap=MinMaxHeap;
